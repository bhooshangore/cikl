set default_tablespace=:cif_default_tablespace;

DROP TABLE IF EXISTS malware CASCADE;
CREATE TABLE malware (
    id BIGSERIAL NOT NULL PRIMARY KEY,
    uuid uuid NOT NULL,
    guid uuid,
    hash text,
    confidence REAL,
    reporttime timestamp with time zone DEFAULT NOW(),
    created timestamp with time zone DEFAULT NOW()
);

CREATE TABLE malware_md5 () INHERITS (malware);
ALTER TABLE malware_md5 ADD PRIMARY KEY (id);

CREATE TABLE malware_sha1 () INHERITS (malware);
ALTER TABLE malware_sha1 ADD PRIMARY KEY (id);

CREATE TABLE malware_uuid () INHERITS (malware);
ALTER TABLE malware_uuid ADD PRIMARY KEY (id);
