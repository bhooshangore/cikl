filter {
  if ([type] == 'event') {
    date {
      match => [ "detecttime", "UNIX" ]
        target => "@timestamp"
        timezone => "UTC"
    }
    date {
      match => [ "reporttime", "UNIX" ]
        target => "reporttime"
        timezone => "UTC"
    }
    mutate {
      remove_field => [ "detecttime" ]
    }

    if ([type] == 'event') {
      if [observables][fqdn][0] {
        generate_dns_queries { }
      }

      cikl_mongodb {
        database => 'cikl'
        uri => 'mongodb://localhost:27017'
      }
    }
    
  }
}
