input {
  rabbitmq {
    host => "<%= scope.lookupvar('cikl::rabbitmq_host') %>"
    port => <%= scope.lookupvar('cikl::rabbitmq_port') %>
    user => "<%= scope.lookupvar('cikl::rabbitmq_username') %>"
    password => "<%= scope.lookupvar('cikl::rabbitmq_password') %>"
    vhost => "<%= scope.lookupvar('cikl::rabbitmq_vhost') %>"
    queue => "cikl.event"
    durable => true
    add_field => {
      'type' => 'event'
    }
  }

  rabbitmq {
    host => "<%= scope.lookupvar('cikl::rabbitmq_host') %>"
    port => <%= scope.lookupvar('cikl::rabbitmq_port') %>
    user => "<%= scope.lookupvar('cikl::rabbitmq_username') %>"
    password => "<%= scope.lookupvar('cikl::rabbitmq_password') %>"
    vhost => "<%= scope.lookupvar('cikl::rabbitmq_vhost') %>"
    queue => "cikl.dns_answer"
    durable => true
    add_field => {
      'type' => 'dns_answer'
    }
  }
}

