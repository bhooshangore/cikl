input {
  rabbitmq {
    host => "<%= scope.lookupvar('cikl::rabbitmq::host') %>"
    port => <%= scope.lookupvar('cikl::rabbitmq::port') %>
    user => "<%= scope.lookupvar('cikl::rabbitmq::username') %>"
    password => "<%= scope.lookupvar('cikl::rabbitmq::password') %>"
    vhost => "<%= scope.lookupvar('cikl::rabbitmq::vhost') %>"
    queue => "cikl.event"
    durable => true
    add_field => {
      'type' => 'event'
    }
  }

  rabbitmq {
    host => "<%= scope.lookupvar('cikl::rabbitmq::host') %>"
    port => <%= scope.lookupvar('cikl::rabbitmq::port') %>
    user => "<%= scope.lookupvar('cikl::rabbitmq::username') %>"
    password => "<%= scope.lookupvar('cikl::rabbitmq::password') %>"
    vhost => "<%= scope.lookupvar('cikl::rabbitmq::vhost') %>"
    queue => "cikl.dns_answer"
    durable => true
    add_field => {
      'type' => 'dns_answer'
    }
  }
}

